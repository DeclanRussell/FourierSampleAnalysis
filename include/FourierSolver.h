#ifndef FOURIERSOLVER_H
#define FOURIERSOLVER_H

//----------------------------------------------------------------------------------------------------------------------
/// @file FourierSolver.h
/// @class FourierSolver
/// @author Declan Russell
/// @date 16/12/2015
/// @version 1.0
/// @brief Class for performing fourier analysis on samples. This app will create a power spectrum image and possibly
/// @brief the radial mean of our power spectrum.
//----------------------------------------------------------------------------------------------------------------------

#include <QString>
#include <vector>
#include <QImage>
#include "float2.h"

class FourierSolver
{
public:
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief default ctor
    //----------------------------------------------------------------------------------------------------------------------
    FourierSolver();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief defaut dtor
    //----------------------------------------------------------------------------------------------------------------------
    ~FourierSolver();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief imports 2D points from file
    //----------------------------------------------------------------------------------------------------------------------
    void import2DFromFile(QString _dir);
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief analysis our points to create our power spectrum
    //----------------------------------------------------------------------------------------------------------------------
    void analysePoints();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief returns our 2D image of our power spectrum
    //----------------------------------------------------------------------------------------------------------------------
    inline QImage getPSImage(){return m_psImage;}
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief mutator to our standard deviation
    /// @param _x - desired standard deviation (float)
    //----------------------------------------------------------------------------------------------------------------------
    inline void  setStandardDeviation(float _x){m_stanDevSqrd = _x*_x;}
    //----------------------------------------------------------------------------------------------------------------------
private:
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our gausian kernal
    //----------------------------------------------------------------------------------------------------------------------
    float gausian(float2 _q, float2 _d);
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our standar deviation squared used in our gausian kernal
    //----------------------------------------------------------------------------------------------------------------------
    float m_stanDevSqrd;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief array of our 2D points
    //----------------------------------------------------------------------------------------------------------------------
    std::vector<float2> m_2DPoints;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief array of our pair-wise sample differentials
    //----------------------------------------------------------------------------------------------------------------------
    std::vector<float2> m_sampleDiff;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our power spectrum image
    //----------------------------------------------------------------------------------------------------------------------
    QImage m_psImage;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our power spectrum information
    //----------------------------------------------------------------------------------------------------------------------
    float **m_ps;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our probability distrobution histogram
    //----------------------------------------------------------------------------------------------------------------------
    float **m_pdf;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our probability density functinon. Takes in a differential and returns the probability density.
    /// @param _x - our differential (float2)
    /// @returns our probability density (float)
    //----------------------------------------------------------------------------------------------------------------------
    float pdf(float2 _x);
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief width resolution of our analysis
    //----------------------------------------------------------------------------------------------------------------------
    int m_width;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief height resolution of our analysis
    //----------------------------------------------------------------------------------------------------------------------
    int m_height;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief range selection of our differentials
    //----------------------------------------------------------------------------------------------------------------------
    float m_rangeSelection;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief axis range of our analysis
    //----------------------------------------------------------------------------------------------------------------------
    float m_axisRange;
    //----------------------------------------------------------------------------------------------------------------------
};

#endif // FOURIERSOLVER_H
